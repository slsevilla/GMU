---
title: "R Notebook"
output: 
  word_document: 
    toc: yes
editor_options: 
  chunk_output_type: console
---
Library
```{r}
library(ggplot2)
library(reshape2)
```

Input Files
```{r}
#Read in data tables, provide column names and unique features of each column
##Education summary by race and gender
race_gender <- read.csv("C:\\Users\\sevillas2\\Google Drive\\My Documents\\Education\\George Mason University\\Stat515\\Re-Design\\Data\\T1_Education_AgeSex(1940-2017).csv", header=TRUE)
##Column headers
colnames(race_gender)
##Unique variables of specific columns
unique(race_gender$Age)
unique(race_gender$Year)

age_gender
race_gender_income
detailed

```

Analysis of Race and Gender
##Recreate Figure 1
```{r}
#Generate table for only age 25 and over with both genders
fig1 <- subset(race_gender,Gender=="Both" & Age=="25 YEARS AND OLDER")

#Combines columns for less than high school, high school or college, and college and above 
for (i in 1:nrow(fig1)){
 fig1[i,"LESS_HS"] <- fig1[i,"ELEM_0to4"] + fig1[i,"ELEM_5to8"] +  fig1[i,"HS_1to3"]
 fig1[i,"HS_SomeCol"] <- fig1[i,"HS_4"] + fig1[i,"COL_1to3"]
}

#Create a new data frame for figure 1
fig1_redo <- data.frame()

count=1
#Create a row for each variable, with year and population information included
for(i in 1:nrow(fig1)){
 #fig1_redo[count,"Year"] <- fig1[i,"Year"]
 #fig1_redo[count,"Label"] <- "Population"
 #fig1_redo[count,"Pop"] <- fig1[i,"Population"]
 #count = count+1
 
 fig1_redo[count,"Year"] <- fig1[i,"Year"]
 fig1_redo[count,"Label"] <- "Less than HS"
 fig1_redo[count,"Pop"] <- fig1[i,"LESS_HS"]
 count = count+1
 
 fig1_redo[count,"Year"] <- fig1[i,"Year"]
 fig1_redo[count,"Label"] <- "HS, some college"
 fig1_redo[count,"Pop"] <- fig1[i,"HS_SomeCol"]
 count = count+1

 fig1_redo[count,"Year"] <- fig1[i,"Year"]
 fig1_redo[count,"Label"] <- "College or higher"
 fig1_redo[count,"Pop"] <- fig1[i,"COL_4plus"]
 count = count+1
}

fig1_redo 

#Create starting and ending frames for labels
fig1_start <- subset(fig1_redo, Year==1940)
fig1_start$cum <- cumsum(fig1_start$Pop)
fig1_end <- subset(fig1_redo,Year==2017)
fig1_end$cum <- cumsum(fig1_end$Pop)

#Generate Area graph
ggplot(fig1_redo,aes(x=Year,y=Pop)) +
 theme_bw() +
 geom_area(aes(fill=Label)) + 
 labs (y="Population", 
       title="Re-Print of Figure 1: Population 25 and over by Educational Attainment 1940-2017") +
 scale_x_continuous(breaks = round(seq(min(fig1_redo$Year), max(fig1_redo$Year), by = 5),1)) +
 scale_y_continuous(breaks = round(seq(0, 250000, by = 50000),1)) +
 geom_text(data=fig1_start,aes(x=1940,y=cum,label=Pop),size=3,position="jitter")+
  geom_text(data=fig1_end,aes(x=2017,y=cum,label=Pop),size=3)
```

##Improve Figure 1 with percents
```{r}
#Create a new data frame for figure 1
fig1_per <- data.frame()

count=1
#Create a row for each variable, with year and population information included
for(i in 1:nrow(fig1)){
 fig1_per[count,"Year"] <- fig1[i,"Year"]
 fig1_per[count,"Label"] <- "Less than HS"
 fig1_per[count,"Per"] <- (fig1[i,"LESS_HS"]/fig1[i,"Population"])*100
 count = count+1
 
 fig1_per[count,"Year"] <- fig1[i,"Year"]
 fig1_per[count,"Label"] <- "HS, some college"
 fig1_per[count,"Per"] <- (fig1[i,"HS_SomeCol"]/fig1[i,"Population"])*100
 count = count+1

 fig1_per[count,"Year"] <- fig1[i,"Year"]
 fig1_per[count,"Label"] <- "College or higher"
 fig1_per[count,"Per"] <- (fig1[i,"COL_4plus"]/fig1[i,"Population"])*100
 count = count+1
}

fig1_per_sub <- subset(fig1_per,Label=="Less than HS")

#Generate graph
ggplot(fig1_per,aes(x=Year,y=Per,color=Label)) +
 geom_smooth()+
 labs(y="Percent Population",
      title="Educational Attainment 1940-2017: Percent of Population")
 
ggplot(fig1_per_sub, aes(x=Year,y=Per))+
 geom_bar(stat="identity")


```
